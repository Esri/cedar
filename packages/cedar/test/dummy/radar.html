<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <title>AmCharts</title>

  </head>
  <body id="" onload="">
    <!-- Styles -->
    <style>
    .chart {
      width: 100%;
      height: 300px;
    }
    </style>

    <!-- Resources -->
    <script src="https://www.amcharts.com/lib/3/amcharts.js"></script>
    <script src="https://www.amcharts.com/lib/3/radar.js"></script>
    <script src="https://www.amcharts.com/lib/3/plugins/export/export.min.js"></script>
    <link rel="stylesheet" href="https://www.amcharts.com/lib/3/plugins/export/export.css" type="text/css" media="all" />
    <script src="https://www.amcharts.com/lib/3/themes/light.js"></script>
    <script src="../../../cedar-utils/dist/cedar-utils.js"></script>
    <script src="../../../cedar-amcharts/dist/cedarAmCharts.js"></script>
    <script src="../../dist/cedar.js"></script>

<!-- Chart code -->
<script>
const charts = {};
const configText = '';
var time_periods = ["Hour", "Day", "Month"];
for(var p=0; p<time_periods.length; p++) {
  var time_period = time_periods[p];
  var offense_types = ["THEFT/OTHER",
    "THEFT F/AUTO",
    "SEX ABUSE",
    "Robbery",
    "MOTOR VEHICLE THEFT",
    "HOMICIDE",
    "BURGLARY",
    "ASSAULT W/DANGEROUS WEAPON",
    "ARSON"];
  var config1 = {
    "type": "radar",
    "datasets": [ ],
    series: []
  };
  for(var i=0; i<offense_types.length; i++) {
    var offense_type = offense_types[i];
    var outStatisticFieldName = "OFFENSE_COUNT_" + i;
    const dataset = {
      "url": "https://services.arcgis.com/bkrWlSKcjUDFDtgw/ArcGIS/rest/services/DC_Crime_2016/FeatureServer/0",
      "query": {
        "where": "OFFENSE='" + offense_type + "'",
        "groupByFieldsForStatistics": "EXTRACT(" + time_period + " from REPORTDATETIME)",
        "outStatistics": [
          {
            "statisticType": "count",
            "onStatisticField": "OFFENSE",
            "outStatisticFieldName": outStatisticFieldName
          }
        ],
        "sqlFormat": "standard"
      }
    }
    const series = {
      "category": {"field": "EXPR_1", "label": time_period},
      "value": {
        "field": outStatisticFieldName,
        "label": offense_type
      }
    }
    config1.datasets.push(dataset)
    config1.series.push(series)
  }
  charts[`chart_${time_period}`] = new Cedar(config1)
  charts[`chart_${time_period}`].show("chartdiv" + time_period);
}
</script>

<!-- HTML -->
<a href="./">&lt; Back Home</a>
<h2>Crime by Hour of Day</h2>
<div id="chartdivHour" class="chart"></div>
<h2>Crime by Day of Month</h2>
<div id="chartdivDay" class="chart"></div>
<h2>Crime by Month</h2>
<div id="chartdivMonth" class="chart"></div>

<pre>
  <!-- TODO: show code -->
  <code>

  </code>
</pre>
  </body>
</html>
